# Terraformコードのモジュール化について

Terraformのコードを作成する前にTerraformのモジュール化について説明します。

## モジュール化の考え方について

Terraformのモジュール化は、インフラ構成を再利用可能な部品として整理し、メンテナンスや拡張を効率的に行うための手法です。

モジュールは一度定義すると、異なる環境やプロジェクトで再利用でき、コードの重複を防ぎます。
モジュール化することで、個々のインフラリソースの定義が簡潔になり、管理がしやすくなるメリットがあります。
また、モジュールの入出力（variables.tfやoutputs.tf）を定義することで、柔軟にパラメータを変更しつつ統一された構成を保つことが可能です。

これにより、保守性やスケーラビリティが向上し、インフラの管理が容易になります。

## terraformのディレクトリ構成について

Terraformプロジェクトのディレクトリ構成は、環境ごとや機能ごとにファイルを分割することで、コードの見通しを良くし、管理の複雑さを軽減するために重要です。

一般的な構成として、environmentディレクトリに本番（prod）、ステージング（staging）、開発（develop）など、環境ごとの設定を配置します。
また、modulesディレクトリにネットワーク設定やユーザー管理といった再利用可能な機能単位のモジュールを配置します。
これにより、各環境がモジュールを利用してインフラを構築できるようになります。
モジュールごとにファイルを分割し、たとえば、main.tfにすべての設定を集中させるのではなく、subnet.tfなどのように適切に分割することで、可読性やメンテナンス性を高めることが可能です。

### ディレクトリ構成

```text
/
├─ doc/
├─ env/       # 環境ごとの設定
│  ├─ prod/
│  │  └─ network/
│  │      ├─ main.tf
│  │      ├─ versions.tf
│  │      └─ provider.tf
│  │
│  ├─ staging/
│  └─ develop/
│
└─ modules/   # 機能単位のモジュール
   ├─ network/
   │  ├─ Readme.md
   │  ├─ main.tf
   │  ├─ variables.tf
   │  ├─ outputs.tf
   │  └─ versions.tf
   │
   └─ user/
```

---

- [前のページに戻る](step03.md)
- [目次](README.md#目次)
- [次のページに進む](step05.md)
