# Terraformの状態管理用S3バケットの作成

Terraformはインフラの状態を「tfstate」ファイルに記録し、次回の実行時にこのファイルを参照することでリソースの差分を管理します。このtfstateファイルには重要な情報が含まれるため、安全に保管する必要があります。デフォルトではローカルに作成されますが、tfstateの内容を外部から書き換えたり削除したりすると、Terraformが認識している状態と実際のリソースの状態に整合性が取れなくなり、正常にTerraformを実行できなくなる恐れがあります。そのため、tfstateファイルは大切に管理することが望ましく、AWSでTerraformを実行する場合は、S3を利用してtfstateファイルを管理するのが一般的です。

## S3バケットの作成

1. AWSコンソールでS3サービスを選択

    AWSコンソールにログインし、検索バーに「S3」と入力してS3サービスを選択します。

1. バケットの作成

    S3ダッシュボードで「Create bucket」（バケットを作成）をクリックします。
    Bucket name に一意の名前を入力します（例: my-project-dev-tfstate-bucket）。名前はリージョン全体で一意である必要があります。
    Region には、Terraformを実行するリージョンを選択します。

1. バージョニングの有効化

    Bucket Versioning で「Enable versioning」（バージョニングを有効化）を選択します。これにより、tfstateファイルの過去バージョンが保存され、誤った変更のリカバリが可能になります。

1. その他の設定

    Block Public Access が有効であることを確認します（デフォルトで有効）。
    暗号化はオプションですが、Server-side encryptionを有効にしてtfstateファイルを暗号化することを推奨します。

1. バケットの作成

    設定を確認し、「Create bucket」（バケットを作成）をクリックします。

---

- [前のページに戻る](step02.md)
- [目次](README.md#目次)
- [次のページに進む](step04.md)
