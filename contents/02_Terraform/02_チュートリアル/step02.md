# 認証情報をローカルに設定

先ほどのコードはAWSアカウントの認証情報をハードコーディングしています。認証情報をTerraformコードにハードコーディングすることは重大なセキュリティリスクです。コードに含めると、誤って公開リポジトリにプッシュされ、悪意のある第三者に取得されるリスクが高まります。また、すべての開発者がその情報にアクセスでき、セキュリティが低下します。さらに、誰がどの認証情報を使用しているか追跡が困難となり、インシデント時の対応が遅れる可能性があります。異なる環境間で認証情報を使い回すことも避けるべきです。

これらの対策として推奨される方法がいくつかあります。

- **環境変数の使用**:

  認証情報は環境変数として設定し、Terraformコード内では環境変数を参照するようにします。これにより、認証情報がコードベースに含まれず、セキュリティが向上します。

- **Terraformの変数ファイルの使用**:

  認証情報を含む変数ファイルを `.gitignore` に追加し、バージョン管理システムに含めないようにします。

- **AWS Secrets ManagerやHashiCorp Vaultの使用**:

  認証情報を安全に管理するための専用サービスを利用し、Terraformコードからこれらのサービスを参照するようにします。

- **EC2インスタンスにインスタンスプロファイルをアタッチ**:

  AWSアカウント内で作成したEC2インスタンスに適切なインスタンスプロファイルをアタッチして実行することで、EC2インスタンス上からAWSリソースにアクセスする際に、必要な権限を確保できます。インスタンスプロファイルを使用することで、AWS CLIやTerraformを実行する際に認証情報を直接指定する必要がなくなり、セキュリティが向上します。

- **CloudShellの利用**:

  適切なIAMユーザーやIAMロールで実行したAWS CloudShellからTerraformを実行することも有効です。CloudShellは、AWS環境内で直接実行できるシェル環境を提供し、デフォルトでAWS CLIの認証情報を設定しています。これにより、ローカルに認証情報を保存する必要がなく、セキュリティリスクを低減できます。

これらの対策を講じることで、認証情報の漏洩リスクを大幅に低減できます。
今回は環境変数に認証情報を設定することで対策します。

## AWSアカウントの認証情報をローカルに設定する

AWSの認証情報をローカルに安全に設定するには、以下の手順を実行します。

### 環境変数を設定する

AWSの認証情報を環境変数に設定します。ターミナルやシェルに以下のコマンドを入力して、AWS_ACCESS_KEY_ID と AWS_SECRET_ACCESS_KEY を設定します。

※ `your_access_key`と`your_secret_key`を実際の認証情報に置き換えます。

```bash
export AWS_ACCESS_KEY_ID=your_access_key
export AWS_SECRET_ACCESS_KEY=your_secret_key
```

---

- [前のページに戻る](step01.md)
- [目次](README.md#目次)
- [次のページに進む](step03.md)
